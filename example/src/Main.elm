module Main exposing (..)

import BoundingBox2d
import Browser
import Bytes exposing (Bytes)
import Bytes.Encode
import Dict
import File.Download
import Hex.Convert
import Html
import Html.Events
import Length
import Pdf exposing (ASizes(..), Orientation(..))
import Pixels
import Point2d
import Quantity
import Vector2d


type alias Model =
    ()


type Msg
    = Download


jpgData : Bytes
jpgData =
    "FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 00 48 00 48 00 00 FF FE 00 13 43 72 65 61 74 65 64 20 77 69 74 68 20 47 49 4D 50 FF DB 00 43 00 03 02 02 03 02 02 03 03 03 03 04 03 03 04 05 08 05 05 04 04 05 0A 07 07 06 08 0C 0A 0C 0C 0B 0A 0B 0B 0D 0E 12 10 0D 0E 11 0E 0B 0B 10 16 10 11 13 14 15 15 15 0C 0F 17 18 16 14 18 12 14 15 14 FF DB 00 43 01 03 04 04 05 04 05 09 05 05 09 14 0D 0B 0D 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 FF C2 00 11 08 00 C8 00 64 03 01 11 00 02 11 01 03 11 01 FF C4 00 1A 00 01 01 01 01 01 01 01 00 00 00 00 00 00 00 00 00 00 08 07 05 04 06 03 FF C4 00 1B 01 01 00 03 01 01 01 01 00 00 00 00 00 00 00 00 00 00 05 06 07 04 08 03 02 FF DA 00 0C 03 01 00 02 10 03 10 00 00 01 FC 6A BB E6 7F 1F 6D 00 00 00 1E 8F D7 CA 8A B0 E3 B3 6D 73 67 00 00 00 00 00 35 E9 7C F7 EE 3B 6A E0 00 04 F9 01 AE F3 3E 5D A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 A5 AC 98 AE B3 2D 40 00 00 22 EA 6F A5 38 3C F2 A0 0A 5A C9 8A EB 32 D4 00 00 02 2E A6 FA 53 83 CF 2A 00 D7 A5 F3 DF B8 ED AB 80 00 13 E4 06 BB CC F9 76 80 00 00 00 00 1A 04 85 4B 3F 8F B6 80 00 00 0F 47 EB E5 45 58 71 DF FF C4 00 1E 10 00 02 01 05 01 01 01 00 00 00 00 00 00 00 00 00 05 20 35 00 03 04 07 17 06 30 02 FF DA 00 08 01 01 00 01 05 02 F5 3E A6 F9 BC BF 95 8B F7 71 6E 82 F7 D8 97 47 FD FC 8F 91 C3 3E 37 9A 0C AE 68 32 B9 A0 CA E6 83 2B 9A 0C AE 68 32 B9 A0 CA 27 8D F9 C2 24 9A D2 09 CF CE A6 B4 82 73 F3 A9 AD 20 9C FC EA 6B 48 27 3F 3A 9A D2 09 CF CE A6 B4 82 73 F3 A9 AD 20 9C FC EA 6B 48 27 3F 3A 9A D2 09 CF CE A6 B4 82 73 F3 A9 AD 20 9C FC EA 6B 48 27 3F 3A 9A D2 09 CF CE A6 B4 82 73 F3 A9 AD 20 9C FC EA 6B 48 27 3F 3A 9A D2 09 CF CE A6 B4 82 73 F3 A9 AD 20 9C FC EA 79 1F 5D 86 00 6F 4B 19 5D 2C 65 74 B1 95 D2 C6 57 4B 19 5D 2C 65 74 B1 94 4F 27 F3 9A 4B EF EA 7C B5 F0 99 7F 2B 16 2E E5 5D 05 E0 71 2D 0F FF C4 00 2D 11 00 00 02 07 07 04 01 05 00 00 00 00 00 00 00 00 01 02 03 04 05 06 35 72 B1 00 16 20 30 52 91 D2 11 21 31 61 51 12 15 40 41 71 FF DA 00 08 01 03 01 01 3F 01 61 30 90 B3 10 95 22 42 F5 4A 3E 47 E3 D0 53 B7 9F E7 40 0C A4 A8 91 A7 20 A3 4A 50 30 0F E8 7B D9 AA E9 AC 91 64 7E DE 4F A9 18 FB 0E DE BB 8F 7F C0 78 5E 15 A6 4A D1 50 20 29 44 04 BD 7B F5 F9 1F 61 F1 6B EA D0 D0 4D 87 95 AF AB 43 41 36 1E 56 BE AD 0D 04 D8 79 5A FA B4 34 13 61 E5 6B EA D0 D0 4D 87 95 AF AB 43 41 36 1E 56 BE AD 0D 04 D8 79 59 45 31 96 55 51 27 3F 93 14 07 70 C2 FA C4 09 20 54 D9 0C 98 7A BC 85 A0 61 7D 62 04 90 2A 6C 86 4C 3D 5E 42 D0 30 BE B1 02 48 15 36 43 26 1E AF 21 68 18 5F 58 81 24 0A 9B 21 93 0F 57 90 B4 0C 2F AC 40 92 05 4D 90 C9 87 AB C8 5A 06 17 D6 20 49 02 A6 C8 64 C3 D5 E4 2D 03 0B EB 10 24 81 53 64 32 61 EA F2 16 81 85 F5 88 12 40 A9 B2 19 30 F5 79 0B 40 C2 FA C4 09 20 54 D9 0C 98 7A BC 85 A0 61 7D 62 04 90 2A 6C 86 4C 3D 5E 42 D0 30 BE B1 02 48 15 36 43 26 1E AF 21 68 18 5F 58 81 24 0A 9B 21 93 0F 57 90 B4 0C 2F AC 40 92 05 4D 90 C9 87 AB C8 5A 06 17 D6 20 49 02 A6 C8 64 C3 D5 E4 2D 03 0B EB 10 24 81 53 64 32 61 EA F2 16 81 85 F5 88 12 40 A9 B2 19 30 F5 79 0B 40 C2 FA C4 09 20 54 D9 0C 98 7A BC 85 A0 61 7D 62 04 90 2A 6C 86 4C 3D 5E 42 D0 30 BE B1 02 48 15 36 43 26 1E AF 21 68 18 5E 17 79 69 AC B4 54 E8 0C 50 00 2F 4E FD 7E 47 D0 FC DA E5 34 35 93 71 E3 6B 94 D0 D6 4D C7 8D AE 53 43 59 37 1E 36 B9 4D 0D 64 DC 78 DA E5 34 35 93 71 E3 6B 94 D0 D6 4D C7 8D AE 53 43 59 37 1E 36 51 42 65 65 54 48 0F E4 A5 00 D8 3F 01 84 DD 42 D3 42 54 69 0D D1 28 79 0F 9F 61 5E DE 3F 9D 04 72 92 A5 46 80 82 91 29 80 A0 1F B1 ED 66 AB D8 B2 75 91 FB 79 FE 94 61 E8 3B FB EE 1D AD FF C4 00 26 11 00 00 05 04 02 02 01 05 00 00 00 00 00 00 00 00 01 02 03 33 71 00 05 20 30 15 51 04 11 12 21 23 32 40 41 FF DA 00 08 01 02 01 01 3F 01 F2 BC A3 2C 6F 41 F8 EB 03 09 47 D9 69 0F 3C 82 4F BA 3F 5F D0 F1 3C 42 2E 4F 91 AB 8D 4B B1 AE 35 2E C6 B8 D4 BB 1A E3 52 EC 6B 8D 4B B1 AE 35 2E C6 B8 D4 BB 1A 50 BF 03 98 A1 FC C6 DA D0 CE 85 DD 3C 8E 36 D6 86 74 2E E9 E4 71 B6 B4 33 A1 77 4F 23 8D B5 A1 9D 0B BA 79 1C 6D AD 0C E8 5D D3 C8 E3 6D 68 67 42 EE 9E 47 1B 6B 43 3A 17 74 F2 38 DB 5A 19 D0 BB A7 91 C6 DA D0 CE 85 DD 3C 8E 36 D6 86 74 2E E9 E4 71 B6 B4 33 A1 77 4F 23 8D B5 A1 9D 0B BA 79 1C 6D AD 0C E8 5D D3 C8 E3 6D 68 67 42 EE 9E 47 1B 6B 43 3A 17 74 F2 38 DB 5A 19 D0 BB A7 91 C6 DA D0 CE 85 DD 3C 8E 36 D6 86 74 2E E9 E4 71 B6 B4 33 A1 77 4F 23 8F 89 E5 91 02 7C 4D 5C 92 5D 0D 72 49 74 35 C9 25 D0 D7 24 97 43 5C 92 5D 0D 72 49 74 35 C9 25 D0 D2 86 F9 9C C6 0F EF E8 79 5E 29 91 37 B0 FC 75 81 44 C3 E8 B4 87 80 40 27 DD 0F AD 7F FF C4 00 2A 10 00 01 02 03 08 01 03 05 00 00 00 00 00 00 00 00 01 02 03 04 74 B2 00 05 11 20 30 33 92 D2 12 21 31 61 15 32 40 52 F0 FF DA 00 08 01 01 00 06 3F 02 71 B6 DC 28 81 49 F1 42 12 4E 0B 18 FD C7 FB D3 4C 38 CB 8A 69 C1 EC B4 1C 08 B2 7E A6 F0 66 29 27 C4 E0 85 1F 31 FB 7A 0F 4F C0 72 22 21 C7 D0 B4 BA 51 83 64 61 86 03 E3 E6 DB F1 7C D3 D6 DB F1 7C D3 D6 DB F1 7C D3 D6 DB F1 7C D3 D6 DB F1 7C D3 D6 DB F1 7C D3 D6 DB F1 7C D3 D6 D1 70 E8 24 A1 A7 54 80 55 EF 80 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 F9 93 4A 74 2F 19 97 2A 39 5F 99 34 A7 42 F1 99 72 A3 95 C8 78 86 DF 5A D4 E9 5E 2D 81 86 18 0F 9F 8B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 6C 45 F0 4F 6B 45 C4 20 10 87 5D 52 C0 57 BE 04 FE 03 8E 36 D9 5C 0A 8F 92 16 90 70 40 C7 ED 3F DE BA 61 B6 5B 53 AE 1F 64 20 62 4D 93 F5 36 43 D1 4A 3E 47 05 A8 78 0F D7 D0 FA DB FF C4 00 1F 10 01 01 00 01 03 05 01 00 00 00 00 00 00 00 00 00 01 11 21 30 41 61 00 31 40 51 A1 70 FF DA 00 08 01 01 00 01 3F 21 71 F4 0C 16 03 8A B0 41 FA AB A5 51 BF 4E E2 31 38 EB 38 30 0C 81 32 04 FA E3 6B 3C 03 52 14 78 3E EB 39 68 22 44 89 12 24 48 BB D0 A7 C2 42 F3 8F DF 03 96 0E 58 39 60 E5 83 96 0E 58 39 60 E5 83 96 0E 58 39 60 E5 83 96 0E 58 39 60 E5 83 96 0E 58 39 63 52 15 7A 1E E3 39 68 22 44 89 12 24 48 BB 50 A7 C2 52 F3 9F 01 C7 D1 31 58 2E 62 50 17 EA 86 95 46 FD 39 8A C0 E3 AC 60 C0 32 04 C0 11 EF 9D E5 EB FF DA 00 0C 03 01 00 02 00 03 00 00 00 10 3F FF 00 FF 00 FF 00 A5 FF 00 FF 00 FF 00 FF 00 FF 00 F0 DB 6D B9 FF 00 EE 49 24 93 FF 00 DC 92 49 27 FF 00 B9 24 92 4F FF 00 72 49 24 9F FE E4 92 49 3F FD C9 24 92 7F FB 92 49 24 FF 00 F7 24 92 49 FF 00 EE 49 24 93 FF 00 DC 92 49 27 FF 00 B9 24 92 4F FF 00 72 49 24 9F FE E4 92 49 3F FD C9 24 92 7F FB 92 49 24 FF 00 F7 24 92 49 FF 00 EE 49 24 93 FF 00 DC 92 49 27 FF 00 B9 24 92 4F FF 00 0D B6 DB 9F FF 00 FF 00 FF 00 FF 00 FF 00 3F FF 00 FF 00 FF 00 A5 FF C4 00 1E 11 01 01 00 01 04 03 01 00 00 00 00 00 00 00 00 00 01 11 31 21 30 41 71 00 40 51 70 FF DA 00 08 01 03 01 01 3F 10 30 02 14 05 69 17 28 00 A9 5C D5 DB 0C A0 88 00 C6 94 68 C4 1E FC AE 40 A5 1B 56 D8 20 82 29 84 15 45 77 C3 80 1A 53 51 E0 A4 1C 7D D7 61 93 26 4C 99 32 64 24 02 B0 C5 05 95 59 5D 2A F7 FB E3 26 CC 9B 32 6C C9 B3 26 CC 9B 32 6C C9 B3 26 CC 9B 32 6C C9 B3 26 CC 9B 32 6C C9 B3 26 CC 9B 32 6C 1C 00 C6 1A 2F 05 20 E7 EE 9B 0C 99 32 64 C9 93 25 20 55 A6 28 0C A0 CA 69 43 AF 40 C0 08 11 05 85 4C 82 20 A0 73 13 6C 32 82 24 01 58 55 81 54 3B F2 B9 02 15 6C 5B 28 86 80 2E 01 41 50 FF C4 00 25 11 00 01 00 0A 03 00 03 01 00 00 00 00 00 00 00 00 01 00 20 21 30 51 A1 B1 D1 F0 F1 11 31 61 40 41 71 91 FF DA 00 08 01 02 01 01 3F 10 22 3F 01 D0 8F A6 AD EB F7 92 5D 0B 18 82 3E C3 0A 02 32 1F 0B 7D 60 67 C0 3F 39 04 1E 19 C4 07 86 29 B4 16 4D A0 B2 6D 05 93 68 2C 9B 41 64 DA 0B 26 D0 59 07 D2 88 8F E1 56 69 40 E3 31 12 AC D2 81 C6 62 25 59 A5 03 8C C4 4A B3 4A 07 19 88 95 66 94 0E 33 11 2A CD 28 1C 66 22 55 9A 50 38 CC 44 AB 34 A0 71 98 89 56 69 40 E3 31 12 AC D2 81 C6 62 25 59 A5 03 8C C4 4A B3 4A 07 19 88 95 66 94 0E 33 11 2A CD 28 1C 66 22 55 9A 50 38 CC 44 AB 34 A0 71 98 89 56 69 40 E3 31 12 AC D2 81 C6 62 25 59 A5 03 8C C4 4A A7 E3 24 93 CB 38 80 F4 41 34 82 E9 A4 17 4D 20 BA 69 05 D3 48 2E 9A 41 74 D2 0B A0 FA 51 13 FD 3F 00 88 7C 97 46 1E 1A 37 BF DE 40 74 2C 22 49 FA 0D 28 08 D8 FD 2C F1 85 A9 FF C4 00 1C 10 01 01 00 03 00 03 01 00 00 00 00 00 00 00 00 00 01 11 21 30 41 00 31 40 70 FF DA 00 08 01 01 00 01 3F 10 08 06 91 42 90 98 73 00 01 AC 3D E7 A5 20 51 09 52 31 C8 A7 7C 2A 77 02 52 21 70 22 19 5A 00 0D EF 58 DD A0 2A 3F 2E D2 06 34 19 32 64 C9 93 26 54 A3 38 28 B2 00 50 2C 02 F0 FD F1 A2 06 88 1A 20 68 81 A2 06 88 1A 20 68 81 A2 06 88 1A 20 68 81 A2 06 88 1A 20 68 81 A2 06 88 1A 20 3A C6 ED 01 15 F9 72 91 33 A0 C9 93 26 4C 99 32 25 19 C0 05 80 A0 01 62 97 AF C0 10 0D 22 81 25 31 E6 04 47 58 7B CF 4A 40 82 56 05 61 80 5E 78 D4 EE 44 A0 46 60 54 12 B0 40 5F FF D9"
        |> String.filter Char.isAlphaNum
        |> Hex.Convert.toBytes
        |> Maybe.withDefault (Bytes.Encode.sequence [] |> Bytes.Encode.encode)


pdf : Bytes
pdf =
    Pdf.pdf "Example pdf"
        (Dict.fromList
            [ ( "image", { size = ( Pixels.pixels 100, Pixels.pixels 200 ), jpgData = jpgData } )
            ]
        )
        [ Pdf.page
            { size = Pdf.paperSize Portrait A4
            , contents =
                [ Pdf.text
                    (Length.points 32)
                    (Pdf.timesRoman { bold = False, italic = False })
                    Point2d.origin
                    "Test\nnextline"
                , Pdf.jpgImage (BoundingBox2d.singleton Point2d.origin) "image"
                , Pdf.text
                    (Length.points 32)
                    (Pdf.helvetica { bold = False, oblique = True })
                    (Point2d.fromTuple Length.points ( 0, 0 ))
                    "Test2"
                ]
            }

        --, Pdf.page
        --    { size = Pdf.paperSize Landscape A6
        --    , contents =
        --        [ Pdf.text
        --            (Length.points 32)
        --            (Pdf.timesRoman { bold = False, italic = False })
        --            Point2d.origin
        --            "Test\nnext"
        --        , Pdf.text
        --            (Length.points 32)
        --            (Pdf.helvetica { bold = False, oblique = True })
        --            (Point2d.fromTuple Length.points ( 0, 0 ))
        --            "Test2"
        --        ]
        --    }
        ]
        |> Pdf.encoder
        |> Bytes.Encode.encode


update : Msg -> Model -> ( Model, Cmd Msg )
update msg model =
    case msg of
        Download ->
            ( model, File.Download.bytes "Example pdf.pdf" "application/pdf" pdf )


view model =
    Html.button [ Html.Events.onClick Download ] [ Html.text "Download" ]


main : Platform.Program () () Msg
main =
    Browser.element
        { init = always ( (), Cmd.none )
        , update = update
        , view = view
        , subscriptions = always Sub.none
        }
